# Production profile configuration
spring.application.name=MedConnect

# Database connection with retry
spring.datasource.url=${SPRING_DATASOURCE_URL:jdbc:sqlserver://db:1433;databaseName=MedConnect;encrypt=true;trustServerCertificate=true;loginTimeout=30;connectRetryCount=5;connectRetryInterval=5}
spring.datasource.driver-class-name=com.microsoft.sqlserver.jdbc.SQLServerDriver
spring.datasource.username=${DB_USER}
spring.datasource.password=${DB_PASSWORD}

# Connection pool settings - optimized for production
spring.datasource.hikari.connection-timeout=60000
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=600000
spring.datasource.hikari.leak-detection-threshold=60000
spring.datasource.hikari.connection-test-query=SELECT 1

# JPA/Hibernate settings
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.connection.provider_disables_autocommit=true
spring.jpa.properties.hibernate.jdbc.time_zone=UTC
spring.jpa.properties.hibernate.use_nationalized_character_data=true

# Startup delay to ensure database is ready
spring.jpa.defer-datasource-initialization=false

# Force use NVARCHAR instead of VARCHAR for Unicode support (Vietnamese)
spring.jpa.properties.hibernate.use_nationalized_character_data=true

# expose health/info
management.endpoints.web.exposure.include=health,info
management.endpoint.health.probes.enabled=true
management.endpoints.web.base-path=/actuator
management.endpoint.health.show-details=when-authorized

